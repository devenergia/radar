# RAD-222: Layout Responsivo (Mobile)

**Fase:** 5 - Frontend
**Tipo:** CSS/Layout
**Prioridade:** Alta
**Status:** PENDENTE
**Dependencias:** RAD-216 a RAD-221
**Base Legal:** REN 1.137/2025 - Art. 106

## Objetivo

Garantir que o portal funcione bem em dispositivos moveis.

## Localizacao

`frontend/src/styles/responsive.css`

## Especificacao

### Breakpoints

| Tamanho | Largura | Layout |
|---------|---------|--------|
| Mobile | < 640px | Stack vertical |
| Tablet | 640-1024px | 2 colunas |
| Desktop | > 1024px | 3 colunas |

### Prioridades Mobile

1. Mapa ocupando 100% da largura
2. Estatisticas compactas
3. Lista colapsavel
4. Touch-friendly (min 44px)

## Implementacao

```css
/* src/styles/responsive.css */

/* Mobile first */
.container-mapa {
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

.mapa-wrapper {
  width: 100%;
  height: 50vh;
  min-height: 300px;
}

.painel-lateral {
  width: 100%;
}

/* Tablet */
@media (min-width: 640px) {
  .mapa-wrapper {
    height: 60vh;
  }

  .container-mapa {
    flex-direction: row;
    flex-wrap: wrap;
  }

  .mapa-wrapper {
    width: 60%;
  }

  .painel-lateral {
    width: 38%;
  }
}

/* Desktop */
@media (min-width: 1024px) {
  .container-mapa {
    flex-wrap: nowrap;
  }

  .mapa-wrapper {
    width: 66%;
    height: 70vh;
  }

  .painel-lateral {
    width: 32%;
  }
}

/* Touch targets */
button,
.clickable {
  min-height: 44px;
  min-width: 44px;
}

/* Legenda mobile */
@media (max-width: 640px) {
  .legenda {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    background: white;
    border-top: 1px solid #e5e7eb;
    padding: 0.5rem;
    display: flex;
    gap: 0.5rem;
    overflow-x: auto;
    z-index: 1000;
  }

  .legenda-item {
    flex-shrink: 0;
    font-size: 0.75rem;
  }
}

/* Popup mobile */
@media (max-width: 640px) {
  .leaflet-popup-content {
    max-width: 280px;
    font-size: 0.875rem;
  }

  .leaflet-popup-content h3 {
    font-size: 1rem;
  }
}

/* Cards estatisticas mobile */
@media (max-width: 640px) {
  .cards-estatisticas {
    grid-template-columns: repeat(2, 1fr);
    gap: 0.5rem;
  }

  .card-metrica {
    padding: 0.75rem;
  }

  .card-metrica .valor {
    font-size: 1.25rem;
  }
}

/* Lista mobile */
@media (max-width: 640px) {
  .lista-interrupcoes {
    display: none;
  }

  .lista-interrupcoes.expanded {
    display: block;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: white;
    z-index: 1001;
    overflow-y: auto;
  }

  .btn-toggle-lista {
    display: flex;
    position: fixed;
    bottom: 60px;
    right: 1rem;
    z-index: 1000;
  }
}

@media (min-width: 641px) {
  .btn-toggle-lista {
    display: none;
  }
}
```

### Componente de Layout

```typescript
// src/components/Layout/ResponsiveLayout.tsx
import { useState } from 'react';
import { MapaRoraima } from '@/components/MapaRoraima';
import { PainelEstatisticas } from '@/components/PainelEstatisticas';
import { ListaInterrupcoes } from '@/components/ListaInterrupcoes';
import { FiltroFaixaDuracao } from '@/components/FiltroFaixaDuracao';

export function ResponsiveLayout() {
  const [showLista, setShowLista] = useState(false);
  const [faixasFiltro, setFaixasFiltro] = useState([]);

  return (
    <div className="min-h-screen bg-gray-100">
      {/* Header */}
      <header className="bg-blue-800 text-white p-4 sticky top-0 z-50">
        <h1 className="text-lg md:text-2xl font-bold truncate">
          Portal de Interrupcoes - Roraima
        </h1>
      </header>

      {/* Main content */}
      <main className="container mx-auto p-2 md:p-4">
        <div className="container-mapa">
          {/* Mapa */}
          <div className="mapa-wrapper">
            <MapaRoraima filtroFaixa={faixasFiltro[0]} />
          </div>

          {/* Painel lateral */}
          <div className="painel-lateral space-y-4">
            <PainelEstatisticas />

            {/* Filtro - visivel em tablet+ */}
            <div className="hidden sm:block">
              <FiltroFaixaDuracao
                selecionadas={faixasFiltro}
                onChange={setFaixasFiltro}
              />
            </div>

            {/* Lista - visivel em desktop */}
            <div className="hidden lg:block">
              <ListaInterrupcoes />
            </div>
          </div>
        </div>
      </main>

      {/* Botao toggle lista (mobile) */}
      <button
        className="btn-toggle-lista bg-blue-600 text-white p-3 rounded-full shadow-lg"
        onClick={() => setShowLista(!showLista)}
      >
        {showLista ? 'Fechar' : 'Ver Lista'}
      </button>

      {/* Lista expandida (mobile) */}
      {showLista && (
        <div className="lista-interrupcoes expanded">
          <div className="p-4 bg-gray-100 flex justify-between items-center sticky top-0">
            <h2 className="font-bold">Interrupcoes Ativas</h2>
            <button
              className="text-blue-600"
              onClick={() => setShowLista(false)}
            >
              Fechar
            </button>
          </div>
          <ListaInterrupcoes />
        </div>
      )}

      {/* Footer */}
      <footer className="bg-gray-800 text-white p-4 text-center text-sm">
        <p>Â© 2025 Roraima Energia - REN 1.137/2025 ANEEL</p>
      </footer>
    </div>
  );
}
```

## Testes

```typescript
// src/components/Layout/ResponsiveLayout.test.tsx
import { render, screen, fireEvent } from '@testing-library/react';
import { describe, it, expect, vi } from 'vitest';
import { ResponsiveLayout } from './ResponsiveLayout';

// Mock viewport
const setViewport = (width: number) => {
  Object.defineProperty(window, 'innerWidth', {
    writable: true,
    configurable: true,
    value: width,
  });
  window.dispatchEvent(new Event('resize'));
};

describe('ResponsiveLayout', () => {
  it('deve mostrar botao de lista em mobile', () => {
    setViewport(400);
    render(<ResponsiveLayout />);

    expect(screen.getByText('Ver Lista')).toBeInTheDocument();
  });

  it('deve abrir lista ao clicar no botao', () => {
    setViewport(400);
    render(<ResponsiveLayout />);

    fireEvent.click(screen.getByText('Ver Lista'));

    expect(screen.getByText('Fechar')).toBeInTheDocument();
  });
});
```

## Criterios de Aceite

- [ ] Layout funciona em mobile (320px+)
- [ ] Layout funciona em tablet (640px+)
- [ ] Layout funciona em desktop (1024px+)
- [ ] Touch targets >= 44px
- [ ] Mapa usavel em mobile
- [ ] Lista colapsavel em mobile
- [ ] Legenda visivel em todas telas
- [ ] Performance aceitavel em mobile
- [ ] Testes passando

## Comando de Execucao

```bash
# Testar em diferentes viewports
npm run dev

# Chrome DevTools > Toggle device toolbar

# Testes
npm test src/components/Layout
```
